<!DOCTYPE html>
<html>
  <head>
    <title>THE PILL</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>THE PILL </title>
    <link rel="styleshhet" href="estilos.css">
    <!-- carga el nucleo de firebase JS SDK -->
  
    <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-app.js"></script>
<!--Agrega el manejo de autentificacion-->

    <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-auth.js"></script>

    <script src="js/init.js"></script>

  </head>
  <body>
    <header>
      <h1>THE PILL</h1>
    </header>
   
    <fieldset>         
    <leged> Email </leged>
    <output id="email"><progres max="100" >cargando..</progress></output>
    </fieldset>
    <fieldset>
      <legend> Nombre </legend>
      <output> id="nombre"</output>
      </dieldset>
    <figure> <img id="avatar" alt="Avatar"></figure>
    <Button type="button" onclick="terminaSesion()">Terminar Sesion</button>
    
    
    <script>
            const auth = firebase.auth();
           
             const provider = new firebase.auth.GoogleAuthProvider();
            
             provider.setCustomParameters({ prompt: "select_account" });
            
             auth.onAuthStateChanged(
             
               usuarioAuth =>{
                  if (usuarioAuth && usuarioAuth.email) {
                      
                    email.value = usuarioAuth.email;
                    
                    nombre.value = usuarioAuth.displayName;
                    
                    avatar.src = usuarioAuth.photoURL;
                  
                  }
                  else {
                      auth.singInWithRedirect(provider);
                      
                  }
              } ,
              procesaError
             );
             async function terminaSesion(){
               try{
                 await auth.signOut();
               }catch (e) {
                 procesaError(e);
                         }
             }
      function procesaError(e){
      console.log(e);
        alert (e.message);
      }
      </script>
    </body>
  </html>
 
